<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é—œè¥¿ 5 å¤© 4 å¤œ</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="é—œè¥¿ä¹‹æ—…">
    <link rel="apple-touch-icon" href="https://img.icons8.com/color/180/torii.png">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Noto+Serif+JP:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        /* CSS Reset */
        * { box-sizing: border-box; -webkit-user-select: none; user-select: none; }
        
        :root {
            /* ç¦ªé¢¨é…è‰² */
            --bg-color: #F4F1EA;
            --text-main: #2B2B2B;
            --text-sub: #6E6B65;
            
            /* å¡ç‰‡é¢¨æ ¼ */
            --card-bg: rgba(255, 255, 255, 0.96);
            --card-border: #E0DCD5;
            --header-bg: rgba(244, 241, 234, 0.92);
            --shadow: 0 4px 20px rgba(43, 43, 43, 0.06);

            /* ä¸»é¡Œå¼·èª¿è‰² */
            --accent-osaka: #B74B4B;
            --accent-kyoto: #6A4C9C;
            --accent-kobe: #3E62AD;
            
            --line-color: #D3D3D3;
        }

        body {
            font-family: 'Noto Sans JP', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            padding-bottom: 100px;
            -webkit-tap-highlight-color: transparent;
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.7;
        }

        /* èƒŒæ™¯åœ–ç‰‡å±¤ */
        #bg-layer {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            z-index: -1;
            transition: opacity 0.6s ease-in-out;
            filter: brightness(0.9) sepia(0.1);
        }
        
        /* é ‚éƒ¨å°èˆª */
        .header {
            background: var(--header-bg);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid rgba(0,0,0,0.03);
            padding-top: env(safe-area-inset-top);
            padding-bottom: 8px;
        }

        .title-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 24px 5px 24px;
        }

        .title-bar {
            font-family: 'Noto Serif JP', serif;
            font-weight: 700;
            font-size: 22px;
            color: var(--text-main);
            letter-spacing: 0.1em;
        }

        /* å¤©æ°£å°å¡ */
        .weather-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #fff;
            padding: 6px 14px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-sub);
            border: 1px solid #E5E0D8;
            box-shadow: 0 2px 6px rgba(0,0,0,0.02);
            transition: all 0.3s ease;
            font-family: 'Noto Serif JP', serif;
        }
        .weather-badge.loading { opacity: 0.7; }
        
        .tabs {
            display: flex;
            overflow-x: auto;
            padding: 10px 20px 12px 20px;
            scrollbar-width: none;
            gap: 16px;
        }
        .tabs::-webkit-scrollbar { display: none; }

        .tab {
            flex: 0 0 auto;
            padding: 6px 0;
            background: transparent;
            font-family: 'Noto Serif JP', serif;
            font-size: 15px;
            font-weight: 600;
            color: #999;
            border: none;
            transition: all 0.4s ease;
            position: relative;
            letter-spacing: 0.05em;
        }
        
        .tab::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 2px;
            background-color: transparent;
            transition: width 0.3s ease;
        }

        body[data-theme="osaka"] .tab.active { color: var(--accent-osaka); }
        body[data-theme="osaka"] .tab.active::after { width: 100%; background-color: var(--accent-osaka); }
        body[data-theme="kyoto"] .tab.active { color: var(--accent-kyoto); }
        body[data-theme="kyoto"] .tab.active::after { width: 100%; background-color: var(--accent-kyoto); }
        body[data-theme="kobe"] .tab.active { color: var(--accent-kobe); }
        body[data-theme="kobe"] .tab.active::after { width: 100%; background-color: var(--accent-kobe); }

        /* å…§å®¹å€èˆ‡å‹•ç•« */
        .content-container {
            position: relative;
            min-height: 80vh;
            padding-top: 10px;
        }

        .content {
            padding: 20px 24px;
            display: none;
            animation-duration: 0.5s;
            animation-timing-function: cubic-bezier(0.22, 1, 0.36, 1);
            animation-fill-mode: both;
        }
        .content.active { display: block; }

        @keyframes slideInRight { from { transform: translateX(30px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes slideInLeft { from { transform: translateX(-30px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        
        .slide-left { animation-name: slideInRight; }
        .slide-right { animation-name: slideInLeft; }

        /* å¡ç‰‡æ¨£å¼ */
        .card {
            background: var(--card-bg);
            border-radius: 8px;
            margin-bottom: 24px;
            border: 1px solid var(--card-border);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
            position: relative;
        }
        
        .card::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: #ccc;
            transition: background 0.3s;
        }
        body[data-theme="osaka"] .card::before { background: var(--accent-osaka); }
        body[data-theme="kyoto"] .card::before { background: var(--accent-kyoto); }
        body[data-theme="kobe"] .card::before { background: var(--accent-kobe); }

        .card-header {
            padding: 22px 24px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: transparent;
            border-bottom: 1px solid rgba(0,0,0,0.03);
            transition: background 0.2s;
        }
        .card-header:active { background: rgba(0,0,0,0.02); }

        .card-header h3 {
            margin: 0;
            font-family: 'Noto Serif JP', serif;
            font-size: 18px;
            font-weight: 700;
            color: var(--text-main);
            display: flex;
            align-items: center;
            gap: 14px;
            letter-spacing: 0.05em;
        }

        .icon-box {
            width: 32px; height: 32px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 18px;
            background: #F4F1EA;
            border: 1px solid #E0DCD5;
            color: #555;
        }

        .toggle-icon { color: #999; font-size: 10px; transition: transform 0.4s; letter-spacing: 2px; }
        .card.expanded .toggle-icon { transform: rotate(180deg); color: var(--text-main); }

        /* åœ°åœ–å€ */
        .map-wrapper {
            height: 0; overflow: hidden;
            transition: height 0.5s cubic-bezier(0.22, 1, 0.36, 1);
            background: #F0F0F0;
            position: relative;
        }
        .map-frame { width: 100%; height: 100%; border: 0; opacity: 0; transition: opacity 0.5s; position: relative; z-index: 2; }
        .map-wrapper.loaded .map-frame { opacity: 1; }

        /* æ™‚é–“è»¸ */
        .details { padding: 15px 24px 30px 24px; }
        .timeline-item { position: relative; padding-left: 32px; margin-top: 30px; border-left: 1px solid var(--line-color); }
        .timeline-item:last-child { border-left-color: transparent; }
        
        .timeline-dot {
            position: absolute; left: -5px; top: 6px;
            width: 11px; height: 11px;
            border-radius: 50%;
            background: #fff;
            border: 2px solid var(--line-color);
            z-index: 1;
            transition: border-color 0.3s;
        }
        body[data-theme="osaka"] .timeline-dot { border-color: var(--accent-osaka); }
        body[data-theme="kyoto"] .timeline-dot { border-color: var(--accent-kyoto); }
        body[data-theme="kobe"] .timeline-dot { border-color: var(--accent-kobe); }

        .time { 
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 13px; 
            font-weight: 600; 
            margin-bottom: 8px; 
            display: block; 
            letter-spacing: 0.05em;
            opacity: 0.8;
        }
        body[data-theme="osaka"] .time { color: var(--accent-osaka); }
        body[data-theme="kyoto"] .time { color: var(--accent-kyoto); }
        body[data-theme="kobe"] .time { color: var(--accent-kobe); }

        .activity { 
            font-size: 15px; 
            line-height: 1.8; 
            color: var(--text-main); 
            text-align: justify;
        }
        .activity strong { 
            font-weight: 600; 
            color: #000; 
            border-bottom: 1px dotted #999; 
        }

        /* æŒ‰éˆ• */
        .btn-group { margin-top: 18px; display: flex; flex-wrap: wrap; gap: 12px; }
        .live-btn {
            display: inline-flex; align-items: center; gap: 8px;
            padding: 8px 18px; border-radius: 4px;
            font-size: 13px; font-weight: 500; text-decoration: none;
            transition: 0.2s; background: #F9F9F9;
            border: 1px solid #DDD; color: var(--text-sub);
            letter-spacing: 0.05em;
            -webkit-user-select: none; user-select: none;
        }
        .live-btn:active { transform: translateY(1px); background: #EEE; }
        .live-btn.train { border-color: rgba(62, 98, 173, 0.3); color: #3E62AD; background: rgba(62, 98, 173, 0.05); }
        .live-btn.walk { border-color: rgba(100, 140, 80, 0.3); color: #648C50; background: rgba(100, 140, 80, 0.05); }

        .note {
            margin-top: 18px; 
            font-size: 13px; 
            color: #5D5545; 
            background: #FDFCF5;
            padding: 16px; 
            border: 1px dashed #C9C0B1;
            border-radius: 6px;
            line-height: 1.6; 
            display: flex; 
            gap: 10px;
        }

        /* === æ‡¸æµ®å·¥å…·ç®± === */
        .fab-container {
            position: fixed; bottom: 35px; right: 25px; z-index: 200;
        }
        .fab-btn {
            width: 52px; height: 52px; border-radius: 12px;
            background: #333; color: #F4F1EA;
            border: 1px solid #555; 
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
            font-size: 22px; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            transition: all 0.3s ease;
        }
        .fab-btn:active { transform: scale(0.95); background: #000; }

        /* æ¨¡æ…‹è¦–çª— */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(40, 40, 40, 0.6); z-index: 300;
            display: none; align-items: center; justify-content: center;
            backdrop-filter: blur(4px);
        }
        .modal-overlay.open { display: flex; animation: fadeIn 0.3s; }
        
        .modal-card {
            width: 88%; max-width: 320px;
            background: #FDFBF7;
            border-radius: 8px;
            padding: 28px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            display: flex; flex-direction: column; gap: 24px;
            border: 1px solid #E5E0D8;
        }
        
        .modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #EEE; padding-bottom: 15px; }
        .modal-title { font-family: 'Noto Serif JP', serif; font-size: 20px; font-weight: 700; color: #333; letter-spacing: 0.1em; }
        .close-btn { background: none; border: none; font-size: 24px; color: #999; cursor: pointer; padding: 0; }

        .tool-title { font-size: 12px; font-weight: 600; color: #888; margin-bottom: 10px; letter-spacing: 0.1em; text-transform: uppercase; }
        
        /* åŒ¯ç‡è¨ˆç®—æ©Ÿ */
        .calc-box { 
            display: flex; gap: 10px; align-items: center; 
            background: #F4F1EA; padding: 12px; border-radius: 4px; border: 1px solid #EBE7E0;
        }
        .calc-input { 
            flex: 1; min-width: 0;
            border: none; background: transparent; 
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 18px; font-weight: 500; color: #333; text-align: right; outline: none; 
        }
        .calc-label { font-size: 13px; font-weight: 500; color: #777; white-space: nowrap; }
        .calc-result { font-size: 18px; font-weight: 700; color: var(--accent-osaka); margin-left: auto; }

        /* æ—¥èªå°å¡ */
        .phrase-list { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .phrase-btn {
            background: #fff; border: 1px solid #E0DCD5; border-radius: 4px;
            padding: 12px 8px; text-align: center; cursor: pointer;
            transition: 0.2s; -webkit-user-select: none;
        }
        .phrase-btn:active { background: #F9F9F9; border-color: #999; }
        .p-jp { display: block; font-family: 'Noto Serif JP', serif; font-size: 14px; font-weight: 600; color: #333; margin-bottom: 4px; }
        .p-zh { display: block; font-size: 11px; color: #888; }

        /* æŒ‰éˆ•å…±ç”¨æ¨£å¼ (åœ°éµåœ– + ç›¸æ©Ÿ) */
        .map-link-btn {
            display: block; width: 100%; padding: 14px;
            background: #5D7259; /* ç«¹é’è‰² */
            color: white;
            text-align: center; text-decoration: none;
            border-radius: 4px; font-weight: 500; font-size: 14px;
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
            letter-spacing: 0.1em;
            transition: background 0.2s;
        }
        .map-link-btn:active { background: #4B5E48; }
        
        .cam-btn { background: #4A4F55; margin-top: 8px; } /* å¢¨ç° */
        .cam-btn:active { background: #2F3439; }

        @keyframes fadeIn { from{opacity:0; transform: translateY(10px);} to{opacity:1; transform: translateY(0);} }
        
    </style>
</head>
<body data-theme="osaka">

    <div id="bg-layer" style="background-image: url('Day1.jpg');"></div>

    <div class="header">
        <div class="title-container">
            <div class="title-bar">é–¢è¥¿ã®æ—…</div>
            <div class="weather-badge" id="weather-widget">
                <span class="weather-icon" id="weather-icon">â³</span>
                <span class="weather-temp" id="weather-temp">Loading...</span>
            </div>
        </div>
        <div class="tabs">
            <button class="tab active" onclick="jumpToTab(0)">å¤§é˜ª</button>
            <button class="tab" onclick="jumpToTab(1)">æ¢…ç”°</button>
            <button class="tab" onclick="jumpToTab(2)">äº¬éƒ½</button>
            <button class="tab" onclick="jumpToTab(3)">ç¥æˆ¶</button>
            <button class="tab" onclick="jumpToTab(4)">å¸°è·¯</button>
        </div>
    </div>

    <div class="content-container" id="swipeArea">

        <div id="d1" class="content active">
            <div class="card" onclick="toggleMap(this, 'Kansai International Airport')">
                <div class="card-header">
                    <h3><div class="icon-box">âœˆï¸</div> æŠµé”èˆ‡ç§»å‹•</h3>
                    <span class="toggle-icon">â–¼</span>
                </div>
                <div class="map-wrapper"></div>
                <div class="details">
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">09:30 - 11:00</span>
                        <span class="activity">é£›æ©ŸæŠµé” KIXã€‚å…¥å¢ƒã€é ˜è¡Œæã€éæµ·é—œã€‚<strong>æ–¼æ©Ÿå ´è³¼è²· ICOCA å¡</strong>ï¼Œè‹¥è‚šå­é¤“å¯å…ˆåœ¨æ©Ÿå ´è¶…å•†ç°¡å–®åƒè¼•é£Ÿã€‚</span>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">11:30 - 12:40</span>
                        <span class="activity">å‰å¾€æ£®ä¹‹å®®é£¯åº—ã€‚<br>è·¯ç·šï¼šJR é—œç©ºå¿«é€Ÿ â†’ å¤§é˜ª/äº¬æ©‹ â†’ è½‰å¤§é˜ªç’°ç‹€ç·š â†’ æ£®ä¹‹å®®ã€‚</span>
                        <div class="btn-group">
                            <a href="https://www.google.com/maps/dir/?api=1&origin=Kansai+International+Airport&destination=Morinomiya+Station&travelmode=transit" target="_blank" class="live-btn train">ğŸšƒ å°èˆªï¼šæ©Ÿå ´ â†’ æ£®ä¹‹å®®</a>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">12:40 - 13:30</span>
                        <span class="activity">é£¯åº— Check-in æˆ–å¯„æ”¾è¡Œæï¼Œæ–¼é£¯åº—é™„è¿‘ç°¡å–®åƒåˆé¤ã€‚</span>
                    </div>
                </div>
            </div>

            <div class="card" onclick="toggleMap(this, 'Osaka Castle Park')">
                <div class="card-header"><h3><div class="icon-box">ğŸ¯</div> å¤§é˜ªåŸå…¬åœ’</h3><span class="toggle-icon">â–¼</span></div>
                <div class="map-wrapper"></div>
                <div class="details">
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">13:30 - 16:00</span>
                        <span class="activity">å¾é£¯åº—èµ°è·¯é€²å…¬åœ’æ•£æ­¥ã€‚è‹¥æƒ³é€²<strong>å¤©å®ˆé–£</strong>è«‹é ç•™ 1.5~2 å°æ™‚ï¼Œä¸æƒ³æ’éšŠå‰‡åœ¨å…¬åœ’å¤–åœæ‹ç…§å³å¯ã€‚</span>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">16:00 - 16:30</span>
                        <span class="activity">å›é£¯åº—ç¨å¾®ä¼‘æ¯ã€æ•´ç†å„€å®¹ï¼ˆå†¬å¤©å¤–é¢å†·ï¼Œå›æˆ¿æš–ä¸€ä¸‹ï¼‰ã€‚</span>
                    </div>
                    <div class="note">âš ï¸ å†¬å¤©å…¬åœ’ç©ºæ› é¢¨å¤§ï¼Œè«‹å‹™å¿…æˆ´å¸½å­èˆ‡åœå·¾ã€‚</div>
                </div>
            </div>

            <div class="card" onclick="toggleMap(this, 'Shinsaibashi-Suji Shopping Street')">
                <div class="card-header"><h3><div class="icon-box">ğŸ›ï¸</div> å¿ƒé½‹æ©‹ & é“é “å €</h3><span class="toggle-icon">â–¼</span></div>
                <div class="map-wrapper"></div>
                <div class="details">
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">16:30 - 16:45</span>
                        <span class="activity">æ­ä¹˜åœ°éµï¼šæ£®ä¹‹å®® â†’ å¿ƒé½‹æ©‹ (é•·å €é¶´è¦‹ç¶ åœ°ç·š)ã€‚</span>
                        <div class="btn-group">
                            <a href="https://www.google.com/maps/dir/?api=1&origin=Morinomiya+Station&destination=Shinsaibashi+Station&travelmode=transit" target="_blank" class="live-btn train">ğŸš‡ å°èˆªï¼šæ£®ä¹‹å®® â†’ å¿ƒé½‹æ©‹</a>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">16:45 - 19:30</span>
                        <span class="activity"><strong>å¿ƒé½‹æ©‹å•†åº—è¡—</strong>ï¼šè—¥å¦ã€æœé£¾æ¡è²·ã€‚<br><strong>ç¾åœ‹æ‘</strong>ï¼šé€›å¤è‘—ã€æ½®ç‰Œã€å°å’–å•¡å»³ã€‚</span>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">19:30 - 21:30</span>
                        <span class="activity"><strong>é“é “å €</strong>ï¼šèµ°åˆ°æˆæ©‹çœ‹æ ¼åŠ›é«˜è·‘è·‘äººã€‚æ™šé¤åƒç« é­šç‡’ã€ä¸²ç‚¸ã€æ‹‰éºµæˆ–èƒèŸ¹ã€‚</span>
                    </div>
                    <div class="note">âš ï¸ äººæ½®æ“æ“ ï¼Œè«‹å°‡èƒŒåŒ…èƒŒåœ¨èƒ¸å‰é˜²ç«Šã€‚</div>
                </div>
            </div>
        </div>

        <div id="d2" class="content">
            <div class="card" onclick="toggleMap(this, 'Osaka Station')">
                <div class="card-header"><h3><div class="icon-box">ğŸ™ï¸</div> æ¢…ç”°å•†åœˆ (ä¸Šåˆ)</h3><span class="toggle-icon">â–¼</span></div>
                <div class="map-wrapper"></div>
                <div class="details">
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">09:20 - 09:40</span>
                        <span class="activity">å‰å¾€æ¢…ç”° (JR å¤§é˜ªç’°ç‹€ç·š: æ£®ä¹‹å®® â†’ å¤§é˜ª)ã€‚</span>
                        <div class="btn-group">
                            <a href="https://www.google.com/maps/dir/?api=1&origin=Morinomiya+Station&destination=Osaka+Station&travelmode=transit" target="_blank" class="live-btn train">ğŸšƒ å°èˆªï¼šæ£®ä¹‹å®® â†’ æ¢…ç”°</a>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">09:40 - 12:00</span>
                        <span class="activity">ç™¾è²¨å·¡ç¦®ï¼š<strong>é˜ªæ€¥ã€é˜ªç¥ã€å¤§ä¸¸ç™¾è²¨</strong>ä¾èˆˆè¶£é¸æ“‡ã€‚<br>æˆ–æ˜¯é€› <strong>Yodobashi Camera</strong> (3Cã€å®¶é›»ã€æ‰­è›‹å€)ã€‚</span>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">12:00 - 13:00</span>
                        <span class="activity">åˆé¤ï¼šåœ¨ç™¾è²¨å…§æˆ–é™„è¿‘äº«ç”¨æ‹‰éºµã€å’–å“©æˆ–å®šé£Ÿã€‚</span>
                    </div>
                </div>
            </div>

            <div class="card" onclick="toggleMap(this, 'LUCUA osaka')">
                <div class="card-header"><h3><div class="icon-box">â˜•</div> æ¢…ç”°æ·±åº¦éŠ (ä¸‹åˆ)</h3><span class="toggle-icon">â–¼</span></div>
                <div class="map-wrapper"></div>
                <div class="details">
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">13:30 - 17:30</span>
                        <span class="activity">æ·±åº¦æ¢ç´¢ï¼šæ¨è–¦ <strong>LUCUA ç™¾è²¨</strong> (å¹´è¼•æ½®æµæœé£¾) æˆ– <strong>Whity åœ°ä¸‹è¡—</strong>ã€‚<br>ä¹Ÿå¯å‰å¾€ä¸­å´ç”ºå’–å•¡è¡—æ•£æ­¥å–ä¸‹åˆèŒ¶ã€‚</span>
                    </div>
                </div>
            </div>

            <div class="card" onclick="toggleMap(this, 'Umeda Sky Building')">
                <div class="card-header"><h3><div class="icon-box">ğŸŒƒ</div> æ¢…ç”°ç©ºä¸­åº­åœ’</h3><span class="toggle-icon">â–¼</span></div>
                <div class="map-wrapper"></div>
                <div class="details">
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">18:00 - 20:00</span>
                        <span class="activity">æ¬£è³ 360 åº¦å¤§é˜ªå¤œæ™¯ã€‚æ™šé¤å¯æ–¼åœ°ä¸‹å±¤ã€Œç€§è¦‹å°è·¯ã€å¾©å¤ç¾é£Ÿè¡—äº«ç”¨ã€‚</span>
                        <div class="btn-group">
                            <a href="https://www.google.com/maps/dir/?api=1&origin=Osaka+Station&destination=Umeda+Sky+Building&travelmode=walking" target="_blank" class="live-btn walk">ğŸš¶ æ­¥è¡Œå°èˆª (ç´„15åˆ†)</a>
                        </div>
                    </div>
                    <div class="note">âš ï¸ æˆ¶å¤–å±•æœ›å±¤é¢¨å¤§æ¥µå†·ï¼Œå¿…å‚™ä¿æš–è¡£ç‰©ã€‚</div>
                </div>
            </div>
        </div>

        <div id="d3" class="content">
            <div class="card" onclick="toggleMap(this, 'Fushimi Inari Taisha')">
                <div class="card-header"><h3><div class="icon-box">â›©ï¸</div> ä¼è¦‹ç¨»è·å¤§ç¤¾</h3><span class="toggle-icon">â–¼</span></div>
                <div class="map-wrapper"></div>
                <div class="details">
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">08:00 - 09:00</span>
                        <span class="activity">å‰å¾€ä¼è¦‹ç¨»è·ã€‚<br>è·¯ç·šï¼šJR ç’°ç‹€ç·šè‡³äº¬æ©‹ â†’ è½‰<strong>äº¬é˜ªæœ¬ç·š</strong>è‡³ä¼è¦‹ç¨»è·ç«™ã€‚</span>
                        <div class="btn-group">
                            <a href="https://www.google.com/maps/dir/?api=1&origin=Morinomiya+Station&destination=Fushimi+Inari+Taisha&travelmode=transit" target="_blank" class="live-btn train">ğŸšƒ å°èˆªï¼šé£¯åº— â†’ ä¼è¦‹ç¨»è·</a>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">09:00 - 11:30</span>
                        <span class="activity">åƒæ‹œæœ¬æ®¿ï¼Œèµ°<strong>åƒæœ¬é³¥å±…</strong>ã€‚å»ºè­°èµ°åˆ°åŠå±±è…°è§€æ™¯å€å³å¯æŠ˜è¿”ï¼Œä¸å¿…æ”»é ‚ã€‚</span>
                    </div>
                    <div class="note">âš ï¸ çˆ¬å¡è¡Œç¨‹ï¼Œè«‹ç©¿å¥½èµ°çš„é‹ã€‚</div>
                </div>
            </div>

            <div class="card" onclick="toggleMap(this, 'Kiyomizu-dera')">
                <div class="card-header"><h3><div class="icon-box">ğŸ‘˜</div> æ¸…æ°´å¯º & äºŒä¸‰å¹´å‚</h3><span class="toggle-icon">â–¼</span></div>
                <div class="map-wrapper"></div>
                <div class="details">
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">13:00 - 15:30</span>
                        <span class="activity">æ­é›»è»Šè‡³æ¸…æ°´äº”æ¢æˆ–ç¥‡åœ’å››æ¢ï¼Œè½‰å…¬è»Šæˆ–æ­¥è¡Œä¸Šå±±ã€‚<br>åƒè§€<strong>æ¸…æ°´èˆå°ã€éŸ³ç¾½ç€‘å¸ƒ</strong>ã€‚<br>å›ç¨‹æ²¿è‘—<strong>äºŒå¹´å‚ã€ä¸‰å¹´å‚</strong>é€›è€è¡—ï¼ŒåƒæŠ¹èŒ¶ç”œé»ã€‚</span>
                    </div>
                    <div class="note">âš ï¸ çŸ³æ¿è·¯é¢å®¹æ˜“æ»‘ï¼Œè¡Œèµ°è«‹å°å¿ƒã€‚</div>
                </div>
            </div>

            <div class="card" onclick="toggleMap(this, 'Gion District')">
                <div class="card-header"><h3><div class="icon-box">ğŸ®</div> ç¥‡åœ’ & å…«å‚ç¥ç¤¾</h3><span class="toggle-icon">â–¼</span></div>
                <div class="map-wrapper"></div>
                <div class="details">
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">15:30 - 19:00</span>
                        <span class="activity">èµ°åˆ°å…«å‚ç¥ç¤¾ç°¡å–®åƒæ‹œï¼Œå†åˆ°<strong>èŠ±è¦‹å°è·¯</strong>çœ‹çœ‹å‚³çµ±ç”ºå®¶å»ºç¯‰ã€‚æ™šé¤æ–¼æ²³åŸç”ºä¸€å¸¶äº«ç”¨ã€‚</span>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">19:30</span>
                        <span class="activity">è¿”å›å¤§é˜ª (äº¬é˜ªæœ¬ç·šç‰¹æ€¥è‡³äº¬æ©‹ â†’ è½‰ JR ç’°ç‹€ç·š)ã€‚</span>
                        <div class="btn-group">
                            <a href="https://www.google.com/maps/dir/?api=1&origin=Gion-Shijo+Station&destination=Morinomiya+Station&travelmode=transit" target="_blank" class="live-btn train">ğŸšƒ å°èˆªï¼šç¥‡åœ’ â†’ é£¯åº—</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="d4" class="content">
            <div class="card" onclick="toggleMap(this, 'Kobe Kitano Ijinkan-Gai')">
                <div class="card-header"><h3><div class="icon-box">âš“</div> åŒ—é‡ç•°äººé¤¨</h3><span class="toggle-icon">â–¼</span></div>
                <div class="map-wrapper"></div>
                <div class="details">
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">09:00 - 09:30</span>
                        <span class="activity">å‰å¾€ç¥æˆ¶ä¸‰å®® (JR ç¥æˆ¶ç·š<strong>æ–°å¿«é€Ÿ</strong>)ã€‚</span>
                        <div class="btn-group">
                            <a href="https://www.google.com/maps/dir/?api=1&origin=Morinomiya+Station&destination=Sannomiya+Station&travelmode=transit" target="_blank" class="live-btn train">ğŸšƒ å°èˆªï¼šé£¯åº— â†’ ç¥æˆ¶ä¸‰å®®</a>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">09:30 - 12:00</span>
                        <span class="activity">å¾ä¸‰å®®åŒ—å£èµ°ä¸Šå¡ï¼Œåƒè§€<strong>åŒ—é‡ç•°äººé¤¨è¡—</strong>ã€‚æŒ‘é¸ 1-2 æ£Ÿæ´‹é¤¨ï¼ˆå¦‚é¢¨è¦‹é›ä¹‹é¤¨ï¼‰åƒè§€ï¼Œå…¶ä»–å¯æ‹è¡—æ™¯ã€‚</span>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">12:00 - 13:30</span>
                        <span class="activity">å›åˆ°ä¸‰å®®é™„è¿‘åˆé¤ã€‚å¯å˜—è©¦<strong>ç¥æˆ¶ç‰›åˆé–“å¥—é¤</strong>ï¼ˆåƒ¹æ ¼è¼ƒè¦ªæ°‘ï¼‰ï¼Œæˆ–åƒæ´‹é£Ÿã€å’–å“©ã€‚</span>
                    </div>
                </div>
            </div>

            <div class="card" onclick="toggleMap(this, 'Nankinmachi')">
                <div class="card-header"><h3><div class="icon-box">ğŸ¥Ÿ</div> å—äº¬ç”º (ä¸­è¯è¡—)</h3><span class="toggle-icon">â–¼</span></div>
                <div class="map-wrapper"></div>
                <div class="details">
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">15:00 - 16:30</span>
                        <span class="activity">èµ°è·¯é€²å—äº¬ç”ºã€‚è²·<strong>è€ç¥¥è¨˜åŒ…å­</strong>ã€å°ç± åŒ…ã€ç³–è‘«è˜†ç­‰ç•¶é»å¿ƒã€‚</span>
                    </div>
                </div>
            </div>

            <div class="card" onclick="toggleMap(this, 'Meriken Park')">
                <div class="card-header"><h3><div class="icon-box">ğŸš¢</div> ç¥æˆ¶æ¸¯å¤œæ™¯</h3><span class="toggle-icon">â–¼</span></div>
                <div class="map-wrapper"></div>
                <div class="details">
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">17:00 - 20:00</span>
                        <span class="activity">èµ°åˆ° <strong>Meriken Park</strong> æ‹ã€ŒBE KOBEã€åœ°æ¨™ã€‚<br>æ™šé¤å‰å¾€ Harborland çš„ <strong>MOSAIC</strong> å•†å ´ï¼Œæ‰¾é–“çœ‹æµ·çš„é¤å»³ç”¨é¤ã€‚</span>
                    </div>
                    <div class="note">â„ï¸ æ¸¯é‚Šæµ·é¢¨å¼·å‹ï¼Œè«‹å‹™å¿…æˆ´åœå·¾å¸½å­ä¿æš–ã€‚</div>
                </div>
            </div>
        </div>

        <div id="d5" class="content">
            <div class="card" onclick="toggleMap(this, 'Kansai International Airport')">
                <div class="card-header"><h3><div class="icon-box">ğŸ›«</div> æ©Ÿå ´å›ç¨‹</h3><span class="toggle-icon">â–¼</span></div>
                <div class="map-wrapper"></div>
                <div class="details">
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">09:00 - 11:00</span>
                        <span class="activity">æœ€å¾Œè£œè²¨æ™‚é–“ã€‚<br>è—¥å¦/è¡£æœï¼šå¿ƒé½‹æ©‹ã€‚<br>3C/å®¶é›»ï¼šæ¢…ç”° Yodobashiã€‚</span>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">11:30</span>
                        <span class="activity">å›åˆ°æ£®ä¹‹å®®é£¯åº—æ‹¿è¡Œæï¼Œå‰å¾€æ©Ÿå ´ã€‚<br><strong>åŸå‰‡ï¼šèµ·é£›å‰ 2.5 ~ 3 å°æ™‚æŠµé”æ©Ÿå ´ã€‚</strong></span>
                        <div class="btn-group">
                            <a href="https://www.google.com/maps/dir/?api=1&origin=Morinomiya+Station&destination=Kansai+International+Airport&travelmode=transit" target="_blank" class="live-btn train">ğŸšƒ å°èˆªï¼šé£¯åº— â†’ æ©Ÿå ´</a>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <span class="time">12:30 - 15:00</span>
                        <span class="activity">æ©Ÿå ´ Check-inã€æ‰˜é‹è¡Œæã€å‡ºå¢ƒã€é€›å…ç¨…åº—ã€ç™»æ©Ÿã€‚</span>
                    </div>
                    <div class="note">âš ï¸ æ¶²é«”ã€è† ç‹€ç‰©è¨˜å¾—è£åœ¨é€æ˜è¢‹æˆ–æ”¾å…¥æ‰˜é‹è¡Œæã€‚</div>
                </div>
            </div>
        </div>

    </div> <div class="fab-container">
        <button class="fab-btn" onclick="toggleModal()">âœ¦</button>
    </div>

    <div class="modal-overlay" id="toolsModal" onclick="closeModalOnBg(event)">
        <div class="modal-card">
            <div class="modal-header">
                <div class="modal-title">æ—…ã®é“å…·</div>
                <button class="close-btn" onclick="toggleModal()">Ã—</button>
            </div>

            <div class="tool-section">
                <div class="tool-title" id="rate-title">ğŸ’´ åŒ¯ç‡ (å›ºå®š 0.2)</div>
                <div class="calc-box">
                    <input type="number" id="yenInput" class="calc-input" placeholder="JPY" oninput="calcRate()">
                    <span class="calc-label">å†† â‰ˆ </span>
                    <span class="calc-result" id="twdResult">0</span>
                    <span class="calc-label">TWD</span>
                </div>
            </div>

            <div class="tool-section">
                <div class="tool-title">ğŸ—£ï¸ ç”Ÿå­˜æ—¥èª</div>
                <div class="phrase-list">
                    <div class="phrase-btn" onclick="speak('Sumimasen')"><span class="p-jp">ã™ã¿ã¾ã›ã‚“</span><span class="p-zh">ä¸å¥½æ„æ€</span></div>
                    <div class="phrase-btn" onclick="speak('Arigatou gozaimasu')"><span class="p-jp">ã‚ã‚ŠãŒã¨ã†</span><span class="p-zh">è¬è¬</span></div>
                    <div class="phrase-btn" onclick="speak('Kore o kudasai')"><span class="p-jp">ã“ã‚Œã‚’ãã ã•ã„</span><span class="p-zh">æˆ‘è¦é€™å€‹</span></div>
                    <div class="phrase-btn" onclick="speak('Okaikei onegaishimasu')"><span class="p-jp">ãŠä¼šè¨ˆ</span><span class="p-zh">è«‹çµå¸³</span></div>
                </div>
            </div>

            <div class="tool-section">
                <div class="tool-title">ğŸ—ºï¸ å¤§é˜ªåœ°éµ</div>
                <a href="https://subway.osakametro.co.jp/cn/guide/routemap.php" target="_blank" class="map-link-btn">
                    è·¯ç·šå›³ã‚’è¦‹ã‚‹
                </a>
            </div>

            <div class="tool-section">
                <div class="tool-title">ğŸ“· ã‚«ãƒ¡ãƒ©ç¿»è¨³</div>
                <a href="https://translate.google.com/?sl=ja&tl=zh-TW&op=images" target="_blank" class="map-link-btn cam-btn">
                    ã‚«ãƒ¡ãƒ©ç¿»è¨³ã‚’èµ·å‹•
                </a>
            </div>
        </div>
    </div>

    <script>
        const bgs = { d1: "Day1.jpg", d2: "Day2.jpg", d3: "Day3.jpg", d4: "Day4.jpg", d5: "Day5.jpg" };
        const coords = { osaka: { lat: 34.6937, lon: 135.5023, name: "å¤§é˜ª" }, kyoto: { lat: 35.0116, lon: 135.7681, name: "äº¬éƒ½" }, kobe: { lat: 34.6901, lon: 135.1955, name: "ç¥æˆ¶" } };
        const weatherCodes = { 0: { icon: 'â˜€ï¸', text: 'æ™´' }, 1: { icon: 'ğŸŒ¤ï¸', text: 'å¤šé›²' }, 2: { icon: 'â˜ï¸', text: 'é™°' }, 3: { icon: 'â˜ï¸', text: 'é™°' }, 51: { icon: 'ğŸŒ§ï¸', text: 'å°é›¨' }, 61: { icon: 'ğŸŒ§ï¸', text: 'é›¨' }, 80: { icon: 'ğŸŒ¦ï¸', text: 'é™£é›¨' }, 95: { icon: 'â›ˆï¸', text: 'é›·é›¨' } };

        // åŒ¯ç‡å›ºå®š
        let currentRate = 0.2;

        // ç•¶å‰é é¢ç´¢å¼• (0-4)
        let currentIndex = 0;
        const totalDays = 5;

        async function fetchWeather(cityKey) {
            const tempEl = document.getElementById('weather-temp');
            const iconEl = document.getElementById('weather-icon');
            try {
                const { lat, lon } = coords[cityKey];
                const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&timezone=Asia%2FTokyo`);
                const data = await res.json();
                const code = data.current_weather.weathercode;
                const info = weatherCodes[code] || { icon: 'ğŸŒ¡ï¸', text: '' };
                iconEl.innerText = info.icon;
                tempEl.innerText = `${coords[cityKey].name} ${Math.round(data.current_weather.temperature)}Â°C`;
            } catch (e) { tempEl.innerText = "å¤©æ°£è¼‰å…¥å¤±æ•—"; }
        }

        // æ ¸å¿ƒåˆ‡æ›åŠŸèƒ½ (æ”¯æ´æ»‘å‹•å‹•ç•«)
        function jumpToTab(index, direction = 'none') {
            if (index < 0 || index >= totalDays) return;
            
            currentIndex = index;
            const dayId = 'd1'; // default
            const ids = ['d1', 'd2', 'd3', 'd4', 'd5'];
            const themes = ['osaka', 'osaka', 'kyoto', 'kobe', 'osaka'];
            const targetId = ids[index];
            const theme = themes[index];

            // è™•ç†å…§å®¹åˆ‡æ›èˆ‡å‹•ç•«
            document.querySelectorAll('.content').forEach(el => {
                el.classList.remove('active', 'slide-left', 'slide-right');
                if (el.id === targetId) {
                    el.classList.add('active');
                    if (direction === 'left') el.classList.add('slide-left');
                    if (direction === 'right') el.classList.add('slide-right');
                }
            });

            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.tab').forEach((el, i) => {
                if (i === index) el.classList.add('active');
                else el.classList.remove('active');
            });
            
            // æ»¾å‹• tab åˆ°å¯è¦‹ç¯„åœ
            const activeTab = document.querySelectorAll('.tab')[index];
            activeTab.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });

            // æ›´æ–°ä¸»é¡Œèˆ‡èƒŒæ™¯
            document.body.setAttribute('data-theme', theme);
            const bg = document.getElementById('bg-layer');
            if (bg.style.backgroundImage !== `url('${bgs[targetId]}')`) {
                bg.style.opacity = 0; setTimeout(() => { bg.style.backgroundImage = `url('${bgs[targetId]}')`; bg.style.opacity = 1; }, 300);
            }
            
            // æ›´æ–°å¤©æ°£
            let city = 'osaka'; if (theme === 'kyoto') city = 'kyoto'; if (theme === 'kobe') city = 'kobe';
            fetchWeather(city);
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ç‚ºäº†ç›¸å®¹åŸæœ¬çš„ onclick å­—ä¸²å‘¼å«ï¼Œä¿ç•™æ­¤ä»‹é¢ä½†å…§éƒ¨è½‰ç™¼
        function switchTab(dayId, theme) {
            const ids = ['d1', 'd2', 'd3', 'd4', 'd5'];
            const idx = ids.indexOf(dayId);
            jumpToTab(idx);
        }

        function toggleMap(card, loc) {
            if(event.target.closest('a')) return;
            card.classList.toggle('expanded');
            const wrap = card.querySelector('.map-wrapper');
            if (card.classList.contains('expanded')) {
                if (!wrap.classList.contains('loaded')) {
                    const enc = encodeURIComponent(loc);
                    // ä½¿ç”¨æ¨™æº– Google Maps åµŒå…¥ç¶²å€
                    wrap.innerHTML = `<iframe class="map-frame" src="http://googleusercontent.com/maps.google.com/maps?q=${enc}&t=m&z=15&output=embed&iwloc=near" frameborder="0"></iframe>`;
                    setTimeout(() => wrap.classList.add('loaded'), 300);
                }
                wrap.style.height = "250px";
            } else { wrap.style.height = "0"; }
        }

        /* å·¥å…·ç®±é‚è¼¯ */
        function toggleModal() {
            const modal = document.getElementById('toolsModal');
            modal.classList.toggle('open');
        }
        function closeModalOnBg(e) {
            if(e.target.id === 'toolsModal') toggleModal();
        }
        function calcRate() {
            const yen = parseFloat(document.getElementById('yenInput').value) || 0;
            const twd = Math.round(yen * currentRate);
            document.getElementById('twdResult').innerText = twd;
        }
        
        function speak(text) {
            speechSynthesis.cancel();
            const u = new SpeechSynthesisUtterance(text);
            u.lang = 'ja-JP';
            u.rate = 0.9;
            const voices = speechSynthesis.getVoices();
            const jpVoice = voices.find(v => v.lang === 'ja-JP' || v.lang === 'ja_JP');
            if (jpVoice) u.voice = jpVoice;
            speechSynthesis.speak(u);
        }
        
        if (typeof speechSynthesis !== 'undefined') {
            speechSynthesis.onvoiceschanged = () => {};
        }

        /* === æ»‘å‹•åµæ¸¬é‚è¼¯ (é˜²æ‰‹éœ‡å„ªåŒ–) === */
        let touchStartX = 0;
        let touchStartY = 0;
        let touchEndX = 0;
        let touchEndY = 0;
        const swipeArea = document.getElementById('swipeArea');

        swipeArea.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
            touchStartY = e.changedTouches[0].screenY;
        }, {passive: true});

        swipeArea.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            touchEndY = e.changedTouches[0].screenY;
            handleSwipe();
        }, {passive: true});

        function handleSwipe() {
            const threshold = 50; // æ»‘å‹•éˆæ•åº¦
            const xDiff = touchEndX - touchStartX;
            const yDiff = touchEndY - touchStartY;
            
            // å‚ç›´é–å®šï¼šåªæœ‰ç•¶æ°´å¹³ç§»å‹•è·é›¢å¤§æ–¼å‚ç›´ç§»å‹•è·é›¢æ™‚ï¼Œæ‰åˆ¤å®šç‚ºæ›é 
            if (Math.abs(xDiff) > Math.abs(yDiff)) {
                if (xDiff < -threshold) {
                    // å‘å·¦æ»‘ (ä¸‹ä¸€é )
                    if (currentIndex < totalDays - 1) {
                        jumpToTab(currentIndex + 1, 'left');
                    }
                } else if (xDiff > threshold) {
                    // å‘å³æ»‘ (ä¸Šä¸€é )
                    if (currentIndex > 0) {
                        jumpToTab(currentIndex - 1, 'right');
                    }
                }
            }
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => { 
            fetchWeather('osaka');
        });
    </script>
</body>
</html>
