<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é—œè¥¿ 5 å¤© 4 å¤œ</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="é—œè¥¿ä¹‹æ—…">
    <link rel="apple-touch-icon" href="https://img.icons8.com/color/180/torii.png">
    
    <style>
        /* äº®è‰²ç³»å…¨åŸŸè®Šæ•¸ */
        :root {
            --primary: #FF5E57;
            --text-main: #1C1C1E;
            --text-sub: #636366;
            --bg-color: #F2F2F7;
            --card-bg: rgba(255, 255, 255, 0.90);
            --card-border: rgba(255, 255, 255, 0.6);
            --header-bg: rgba(255, 255, 255, 0.85);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.08);

            /* ä¸»é¡Œå¼·èª¿è‰² */
            --accent-osaka: #FF3B30;
            --accent-kyoto: #AF52DE;
            --accent-kobe: #007AFF;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            padding-bottom: 100px; /* å¢åŠ åº•éƒ¨ç•™ç™½çµ¦æ‡¸æµ®æŒ‰éˆ• */
            -webkit-tap-highlight-color: transparent;
            min-height: 100vh;
        }

        /* èƒŒæ™¯åœ–ç‰‡å±¤ */
        #bg-layer {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            z-index: -1;
            transition: opacity 0.5s ease-in-out;
            filter: brightness(0.95); 
        }
        
        /* é ‚éƒ¨å°èˆªå€å¡Š */
        .header {
            background: var(--header-bg);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            padding-top: env(safe-area-inset-top);
            padding-bottom: 5px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
        }

        .title-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 20px 5px 20px;
        }

        .title-bar {
            font-weight: 800;
            font-size: 20px;
            color: var(--text-main);
            letter-spacing: -0.5px;
        }

        /* å¤©æ°£å°å¡ */
        .weather-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            background: rgba(255, 255, 255, 0.6);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-main);
            border: 1px solid rgba(0,0,0,0.05);
            box-shadow: 0 2px 10px rgba(0,0,0,0.03);
            transition: all 0.3s ease;
        }
        .weather-badge.loading { opacity: 0.7; }
        
        .tabs {
            display: flex;
            overflow-x: auto;
            padding: 10px 15px 12px 15px;
            scrollbar-width: none;
            gap: 12px;
        }
        .tabs::-webkit-scrollbar { display: none; }

        .tab {
            flex: 0 0 auto;
            padding: 8px 18px;
            border-radius: 20px;
            background: rgba(0, 0, 0, 0.04);
            font-size: 13px;
            font-weight: 600;
            color: var(--text-sub);
            border: none;
            transition: all 0.3s;
        }

        /* å‹•æ…‹ä¸»é¡Œè‰²æŒ‰éˆ• */
        body[data-theme="osaka"] .tab.active { background: var(--accent-osaka); color: white; box-shadow: 0 4px 12px rgba(255, 59, 48, 0.35); transform: scale(1.02); }
        body[data-theme="kyoto"] .tab.active { background: var(--accent-kyoto); color: white; box-shadow: 0 4px 12px rgba(175, 82, 222, 0.35); transform: scale(1.02); }
        body[data-theme="kobe"] .tab.active { background: var(--accent-kobe); color: white; box-shadow: 0 4px 12px rgba(0, 122, 255, 0.35); transform: scale(1.02); }

        /* å…§å®¹å€ */
        .content {
            padding: 20px;
            display: none;
            animation: slideUp 0.5s cubic-bezier(0.165, 0.84, 0.44, 1);
        }
        .content.active { display: block; }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* å¡ç‰‡æ¨£å¼ */
        .card {
            background: var(--card-bg);
            border-radius: 24px;
            margin-bottom: 20px;
            border: 1px solid var(--card-border);
            overflow: hidden;
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            box-shadow: var(--shadow);
            transition: transform 0.2s;
        }

        .card-header {
            padding: 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255,255,255,0.5);
            border-bottom: 1px solid rgba(0,0,0,0.03);
            transition: background 0.2s;
        }
        .card-header:active { background: rgba(255,255,255,0.8); }

        .card-header h3 {
            margin: 0;
            font-size: 17px;
            font-weight: 700;
            color: var(--text-main);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .icon-box {
            width: 36px; height: 36px;
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 20px;
            background: #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .toggle-icon { color: #C7C7CC; font-size: 12px; transition: transform 0.4s; }
        .card.expanded .toggle-icon { transform: rotate(180deg); color: var(--text-main); }

        /* åœ°åœ–å€ */
        .map-wrapper {
            height: 0; overflow: hidden;
            transition: height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: #E5E5EA;
            position: relative;
        }
        .map-wrapper::before {
            content: 'åœ°åœ–è¼‰å…¥ä¸­...';
            position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%);
            color: #8E8E93; font-size: 13px;
        }
        .map-frame { width: 100%; height: 100%; border: 0; opacity: 0; transition: opacity 0.5s; position: relative; z-index: 2; }
        .map-wrapper.loaded .map-frame { opacity: 1; }

        /* æ™‚é–“è»¸èˆ‡ç´°ç¯€ */
        .details { padding: 10px 24px 28px 24px; }
        .timeline-item { position: relative; padding-left: 28px; margin-top: 24px; border-left: 2px solid rgba(0,0,0,0.06); }
        .timeline-item:last-child { border-left-color: transparent; }
        .timeline-dot {
            position: absolute; left: -7px; top: 0;
            width: 12px; height: 12px;
            border-radius: 50%;
            background: #fff;
            box-shadow: 0 0 0 4px rgba(255,255,255,0.8);
            z-index: 1;
        }
        body[data-theme="osaka"] .timeline-dot { background: var(--accent-osaka); }
        body[data-theme="kyoto"] .timeline-dot { background: var(--accent-kyoto); }
        body[data-theme="kobe"] .timeline-dot { background: var(--accent-kobe); }

        .time { font-size: 13px; font-weight: 700; margin-bottom: 6px; display: block; letter-spacing: 0.5px; }
        body[data-theme="osaka"] .time { color: var(--accent-osaka); }
        body[data-theme="kyoto"] .time { color: var(--accent-kyoto); }
        body[data-theme="kobe"] .time { color: var(--accent-kobe); }

        .activity { font-size: 15px; line-height: 1.6; color: var(--text-main); }
        .btn-group { margin-top: 14px; display: flex; flex-wrap: wrap; gap: 10px; }
        .live-btn {
            display: inline-flex; align-items: center; gap: 6px;
            padding: 8px 16px; border-radius: 18px;
            font-size: 13px; font-weight: 600; text-decoration: none;
            transition: 0.2s; background: #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06); border: 1px solid rgba(0,0,0,0.02);
        }
        .live-btn:active { transform: scale(0.96); background: #f5f5f5; }
        .live-btn.train { color: #007AFF; }
        .live-btn.walk { color: #34C759; }

        .note {
            margin-top: 14px; font-size: 13px; color: #856404; background: #FFF8E1;
            padding: 14px; border-radius: 16px; line-height: 1.5; display: flex; gap: 8px;
        }

        /* === æ‡¸æµ®å·¥å…·ç®±æ¨£å¼ === */
        .fab-container {
            position: fixed; bottom: 30px; right: 20px; z-index: 200;
        }
        .fab-btn {
            width: 56px; height: 56px; border-radius: 28px;
            background: #2c3e50; color: white;
            border: none; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            font-size: 24px; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            transition: transform 0.2s;
        }
        .fab-btn:active { transform: scale(0.9); }

        /* æ¨¡æ…‹è¦–çª— (Modal) */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); z-index: 300;
            display: none; align-items: center; justify-content: center;
            backdrop-filter: blur(5px);
        }
        .modal-overlay.open { display: flex; animation: fadeIn 0.2s; }
        
        .modal-card {
            width: 85%; max-width: 320px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .modal-title { font-size: 18px; font-weight: 800; color: #333; }
        .close-btn { background: none; border: none; font-size: 24px; color: #999; cursor: pointer; }

        /* å·¥å…·å€å¡Š */
        .tool-section { margin-bottom: 20px; }
        .tool-title { font-size: 13px; font-weight: 700; color: #666; margin-bottom: 10px; letter-spacing: 1px; }
        
        /* åŒ¯ç‡è¨ˆç®—æ©Ÿ */
        .calc-box { display: flex; gap: 10px; align-items: center; background: #f0f2f5; padding: 10px; border-radius: 12px; }
        .calc-input { width: 100px; border: none; background: transparent; font-size: 18px; font-weight: bold; color: #333; text-align: right; outline: none; }
        .calc-label { font-size: 14px; font-weight: 600; color: #666; }
        .calc-result { font-size: 18px; font-weight: bold; color: #007AFF; margin-left: auto; }

        /* æ—¥èªå°å¡ */
        .phrase-list { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .phrase-btn {
            background: #fff; border: 1px solid #eee; border-radius: 12px;
            padding: 10px; text-align: center; cursor: pointer;
            transition: 0.2s;
        }
        .phrase-btn:active { background: #f0f8ff; border-color: #007AFF; }
        .p-jp { display: block; font-size: 14px; font-weight: 700; color: #333; margin-bottom: 2px; }
        .p-zh { display: block; font-size: 11px; color: #888; }

        /* åœ°éµåœ–æŒ‰éˆ• */
        .map-link-btn {
            display: block; width: 100%; padding: 12px;
            background: #28C76F; color: white;
            text-align: center; text-decoration: none;
            border-radius: 12px; font-weight: 700; font-size: 14px;
        }

        @keyframes fadeIn { from{opacity:0;} to{opacity:1;} }
        
    </style>
</head>
<body data-theme="osaka">

    <div id="bg-layer" style="background-image: url('Day1.jpg');"></div>

    <div class="header">
        <div class="title-container">
            <div class="title-bar">ğŸ‡¯ğŸ‡µ é—œè¥¿ä¹‹æ—…</div>
            <div class="weather-badge" id="weather-widget">
                <span class="weather-icon" id="weather-icon">â³</span>
                <span class="weather-temp" id="weather-temp">Loading...</span>
            </div>
        </div>
        <div class="tabs">
            <button class="tab active" onclick="switchTab('d1', 'osaka')">D1 å¤§é˜ª</button>
            <button class="tab" onclick="switchTab('d2', 'osaka')">D2 æ¢…ç”°</button>
            <button class="tab" onclick="switchTab('d3', 'kyoto')">D3 äº¬éƒ½</button>
            <button class="tab" onclick="switchTab('d4', 'kobe')">D4 ç¥æˆ¶</button>
            <button class="tab" onclick="switchTab('d5', 'osaka')">D5 å›ç¨‹</button>
        </div>
    </div>

    <div id="d1" class="content active">
        <div class="card" onclick="toggleMap(this, 'Kansai International Airport')">
            <div class="card-header">
                <h3><div class="icon-box">âœˆï¸</div> æŠµé”èˆ‡ç§»å‹•</h3>
                <span class="toggle-icon">â–¼</span>
            </div>
            <div class="map-wrapper"></div>
            <div class="details">
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <span class="time">09:30 - 11:30</span>
                    <span class="activity">é£›æ©ŸæŠµé” KIXã€‚æ–¼æ©Ÿå ´è³¼è²· ICOCA å¡ã€‚</span>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <span class="time">11:30 - 12:40</span>
                    <span class="activity">å‰å¾€æ£®ä¹‹å®®é£¯åº—ã€‚</span>
                    <div class="btn-group">
                        <a href="https://www.google.com/maps/dir/?api=1&origin=Kansai+International+Airport&destination=Morinomiya+Station&travelmode=transit" target="_blank" class="live-btn train">ğŸšƒ å°èˆªï¼šæ©Ÿå ´ â†’ æ£®ä¹‹å®®</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="card" onclick="toggleMap(this, 'Osaka Castle Park')">
            <div class="card-header"><h3><div class="icon-box">ğŸ¯</div> å¤§é˜ªåŸå…¬åœ’</h3><span class="toggle-icon">â–¼</span></div>
            <div class="map-wrapper"></div>
            <div class="details">
                <div class="timeline-item"><div class="timeline-dot"></div><span class="time">13:30 - 16:00</span><span class="activity">å…¬åœ’æ•£æ­¥ã€‚</span></div>
                <div class="note">âš ï¸ å†¬å¤©é¢¨å¤§è«‹æˆ´å¸½å­ã€‚</div>
            </div>
        </div>
        <div class="card" onclick="toggleMap(this, 'Shinsaibashi-Suji Shopping Street')">
            <div class="card-header"><h3><div class="icon-box">ğŸ›ï¸</div> å¿ƒé½‹æ©‹ & é“é “å €</h3><span class="toggle-icon">â–¼</span></div>
            <div class="map-wrapper"></div>
            <div class="details">
                <div class="timeline-item"><div class="timeline-dot"></div><span class="time">16:30 - 21:30</span><span class="activity">é€›è¡—è³¼ç‰©ã€æ™šé¤ã€‚</span><div class="btn-group"><a href="https://www.google.com/maps/dir/?api=1&origin=Morinomiya+Station&destination=Shinsaibashi+Station&travelmode=transit" target="_blank" class="live-btn train">ğŸš‡ å°èˆªï¼šæ£®ä¹‹å®® â†’ å¿ƒé½‹æ©‹</a></div></div>
            </div>
        </div>
    </div>

    <div id="d2" class="content">
        <div class="card" onclick="toggleMap(this, 'Osaka Station')">
            <div class="card-header"><h3><div class="icon-box">ğŸ™ï¸</div> æ¢…ç”°å•†åœˆ (ä¸Šåˆ)</h3><span class="toggle-icon">â–¼</span></div>
            <div class="map-wrapper"></div>
            <div class="details">
                <div class="timeline-item"><div class="timeline-dot"></div><span class="time">09:20 - 12:00</span><span class="activity">å‰å¾€æ¢…ç”°é€›è¡—ã€‚</span><div class="btn-group"><a href="https://www.google.com/maps/dir/?api=1&origin=Morinomiya+Station&destination=Osaka+Station&travelmode=transit" target="_blank" class="live-btn train">ğŸšƒ å°èˆªï¼šæ£®ä¹‹å®® â†’ æ¢…ç”°</a></div></div>
            </div>
        </div>
        <div class="card" onclick="toggleMap(this, 'Umeda Sky Building')">
            <div class="card-header"><h3><div class="icon-box">ğŸŒƒ</div> æ¢…ç”°ç©ºä¸­åº­åœ’</h3><span class="toggle-icon">â–¼</span></div>
            <div class="map-wrapper"></div>
            <div class="details">
                <div class="timeline-item"><div class="timeline-dot"></div><span class="time">18:00 - 20:00</span><span class="activity">çœ‹å¤œæ™¯ã€‚</span><div class="btn-group"><a href="https://www.google.com/maps/dir/?api=1&origin=Osaka+Station&destination=Umeda+Sky+Building&travelmode=walking" target="_blank" class="live-btn walk">ğŸš¶ æ­¥è¡Œå°èˆª</a></div></div>
            </div>
        </div>
    </div>

    <div id="d3" class="content">
        <div class="card" onclick="toggleMap(this, 'Fushimi Inari Taisha')">
            <div class="card-header"><h3><div class="icon-box">â›©ï¸</div> ä¼è¦‹ç¨»è·å¤§ç¤¾</h3><span class="toggle-icon">â–¼</span></div>
            <div class="map-wrapper"></div>
            <div class="details">
                <div class="timeline-item"><div class="timeline-dot"></div><span class="time">09:00 - 11:30</span><span class="activity">åƒæœ¬é³¥å±…ã€‚</span><div class="btn-group"><a href="https://www.google.com/maps/dir/?api=1&origin=Morinomiya+Station&destination=Fushimi+Inari+Taisha&travelmode=transit" target="_blank" class="live-btn train">ğŸšƒ å°èˆªï¼šé£¯åº— â†’ ä¼è¦‹ç¨»è·</a></div></div>
            </div>
        </div>
        <div class="card" onclick="toggleMap(this, 'Kiyomizu-dera')">
            <div class="card-header"><h3><div class="icon-box">ğŸ‘˜</div> æ¸…æ°´å¯º & äºŒä¸‰å¹´å‚</h3><span class="toggle-icon">â–¼</span></div>
            <div class="map-wrapper"></div>
            <div class="details">
                <div class="timeline-item"><div class="timeline-dot"></div><span class="time">13:00 - 15:30</span><span class="activity">æ¸…æ°´èˆå°ã€è€è¡—ã€‚</span></div>
            </div>
        </div>
        <div class="card" onclick="toggleMap(this, 'Gion District')">
            <div class="card-header"><h3><div class="icon-box">ğŸ®</div> ç¥‡åœ’</h3><span class="toggle-icon">â–¼</span></div>
            <div class="map-wrapper"></div>
            <div class="details">
                <div class="timeline-item"><div class="timeline-dot"></div><span class="time">19:30</span><span class="activity">è¿”å›å¤§é˜ªã€‚</span><div class="btn-group"><a href="https://www.google.com/maps/dir/?api=1&origin=Gion-Shijo+Station&destination=Morinomiya+Station&travelmode=transit" target="_blank" class="live-btn train">ğŸšƒ å°èˆªï¼šç¥‡åœ’ â†’ é£¯åº—</a></div></div>
            </div>
        </div>
    </div>

    <div id="d4" class="content">
        <div class="card" onclick="toggleMap(this, 'Kobe Kitano Ijinkan-Gai')">
            <div class="card-header"><h3><div class="icon-box">âš“</div> åŒ—é‡ç•°äººé¤¨</h3><span class="toggle-icon">â–¼</span></div>
            <div class="map-wrapper"></div>
            <div class="details">
                <div class="timeline-item"><div class="timeline-dot"></div><span class="time">09:30 - 12:00</span><span class="activity">æ´‹é¤¨æ•£æ­¥ã€‚</span><div class="btn-group"><a href="https://www.google.com/maps/dir/?api=1&origin=Morinomiya+Station&destination=Sannomiya+Station&travelmode=transit" target="_blank" class="live-btn train">ğŸšƒ å°èˆªï¼šé£¯åº— â†’ ç¥æˆ¶ä¸‰å®®</a></div></div>
            </div>
        </div>
        <div class="card" onclick="toggleMap(this, 'Nankinmachi')">
            <div class="card-header"><h3><div class="icon-box">ğŸ¥Ÿ</div> å—äº¬ç”º</h3><span class="toggle-icon">â–¼</span></div>
            <div class="map-wrapper"></div>
            <div class="details"><div class="timeline-item"><div class="timeline-dot"></div><span class="time">15:00</span><span class="activity">ä¸­è¯è¡—é»å¿ƒã€‚</span></div></div>
        </div>
        <div class="card" onclick="toggleMap(this, 'Meriken Park')">
            <div class="card-header"><h3><div class="icon-box">ğŸš¢</div> ç¥æˆ¶æ¸¯å¤œæ™¯</h3><span class="toggle-icon">â–¼</span></div>
            <div class="map-wrapper"></div>
            <div class="details"><div class="timeline-item"><div class="timeline-dot"></div><span class="time">17:00</span><span class="activity">BE KOBE åœ°æ¨™ã€‚</span></div></div>
        </div>
    </div>

    <div id="d5" class="content">
        <div class="card" onclick="toggleMap(this, 'Kansai International Airport')">
            <div class="card-header"><h3><div class="icon-box">ğŸ›«</div> æ©Ÿå ´å›ç¨‹</h3><span class="toggle-icon">â–¼</span></div>
            <div class="map-wrapper"></div>
            <div class="details">
                <div class="timeline-item"><div class="timeline-dot"></div><span class="time">11:30</span><span class="activity">å‰å¾€æ©Ÿå ´ã€‚</span><div class="btn-group"><a href="https://www.google.com/maps/dir/?api=1&origin=Morinomiya+Station&destination=Kansai+International+Airport&travelmode=transit" target="_blank" class="live-btn train">ğŸšƒ å°èˆªï¼šé£¯åº— â†’ æ©Ÿå ´</a></div></div>
            </div>
        </div>
    </div>

    <div class="fab-container">
        <button class="fab-btn" onclick="toggleModal()">ğŸ§°</button>
    </div>

    <div class="modal-overlay" id="toolsModal" onclick="closeModalOnBg(event)">
        <div class="modal-card">
            <div class="modal-header">
                <div class="modal-title">æ—…éŠå°å·¥å…·</div>
                <button class="close-btn" onclick="toggleModal()">Ã—</button>
            </div>

            <div class="tool-section">
                <div class="tool-title">ğŸ’´ åŒ¯ç‡è©¦ç®— (ç´„ 0.22)</div>
                <div class="calc-box">
                    <input type="number" id="yenInput" class="calc-input" placeholder="æ—¥å¹£" oninput="calcRate()">
                    <span class="calc-label">å†† â‰ˆ </span>
                    <span class="calc-result" id="twdResult">0</span>
                    <span class="calc-label">å°å¹£</span>
                </div>
            </div>

            <div class="tool-section">
                <div class="tool-title">ğŸ—£ï¸ ç”Ÿå­˜æ—¥èª (é»æ“Š)</div>
                <div class="phrase-list">
                    <div class="phrase-btn" onclick="speak('Sumimasen')"><span class="p-jp">ã™ã¿ã¾ã›ã‚“</span><span class="p-zh">ä¸å¥½æ„æ€</span></div>
                    <div class="phrase-btn" onclick="speak('Arigatou gozaimasu')"><span class="p-jp">ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™</span><span class="p-zh">è¬è¬</span></div>
                    <div class="phrase-btn" onclick="speak('Kore o kudasai')"><span class="p-jp">ã“ã‚Œã‚’ãã ã•ã„</span><span class="p-zh">æˆ‘è¦é€™å€‹</span></div>
                    <div class="phrase-btn" onclick="speak('Okaikei onegaishimasu')"><span class="p-jp">ãŠä¼šè¨ˆãŠé¡˜ã„ã—ã¾ã™</span><span class="p-zh">è«‹çµå¸³</span></div>
                    <div class="phrase-btn" onclick="speak('Toire wa doko desu ka')"><span class="p-jp">ãƒˆã‚¤ãƒ¬ã¯ã©ã“ã§ã™ã‹</span><span class="p-zh">å»æ‰€åœ¨å“ª</span></div>
                    <div class="phrase-btn" onclick="speak('Eigo menyu wa arimasu ka')"><span class="p-jp">è‹±èªãƒ¡ãƒ‹ãƒ¥ãƒ¼...</span><span class="p-zh">æœ‰è‹±æ–‡èœå–®å—</span></div>
                </div>
            </div>

            <div class="tool-section">
                <div class="tool-title">ğŸ—ºï¸ å¯¦ç”¨é€£çµ</div>
                <a href="https://subway.osakametro.co.jp/cn/img/osakametro_rosenzu_cn_20240323.pdf" target="_blank" class="map-link-btn">
                    ğŸ“„ é–‹å•Ÿå¤§é˜ªåœ°éµåœ– (PDF)
                </a>
            </div>
        </div>
    </div>

    <script>
        const bgs = { d1: "Day1.jpg", d2: "Day2.jpg", d3: "Day3.jpg", d4: "Day4.jpg", d5: "Day5.jpg" };
        const coords = { osaka: { lat: 34.6937, lon: 135.5023, name: "å¤§é˜ª" }, kyoto: { lat: 35.0116, lon: 135.7681, name: "äº¬éƒ½" }, kobe: { lat: 34.6901, lon: 135.1955, name: "ç¥æˆ¶" } };
        const weatherCodes = { 0: { icon: 'â˜€ï¸', text: 'æ™´æœ—' }, 1: { icon: 'ğŸŒ¤ï¸', text: 'å¤šé›²' }, 2: { icon: 'â˜ï¸', text: 'é™°å¤©' }, 3: { icon: 'â˜ï¸', text: 'é™°å¤©' }, 51: { icon: 'ğŸŒ§ï¸', text: 'å°é›¨' }, 61: { icon: 'ğŸŒ§ï¸', text: 'ä¸‹é›¨' }, 80: { icon: 'ğŸŒ¦ï¸', text: 'é™£é›¨' }, 95: { icon: 'â›ˆï¸', text: 'é›·é›¨' } };

        async function fetchWeather(cityKey) {
            const tempEl = document.getElementById('weather-temp');
            const iconEl = document.getElementById('weather-icon');
            try {
                const { lat, lon } = coords[cityKey];
                const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&timezone=Asia%2FTokyo`);
                const data = await res.json();
                const code = data.current_weather.weathercode;
                const info = weatherCodes[code] || { icon: 'ğŸŒ¡ï¸', text: '' };
                iconEl.innerText = info.icon;
                tempEl.innerText = `${coords[cityKey].name} ${Math.round(data.current_weather.temperature)}Â°C`;
            } catch (e) { tempEl.innerText = "å¤©æ°£è¼‰å…¥å¤±æ•—"; }
        }

        function switchTab(dayId, theme) {
            document.querySelectorAll('.content').forEach(el => el.classList.remove('active'));
            document.getElementById(dayId).classList.add('active');
            document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));
            const idx = ['d1','d2','d3','d4','d5'].indexOf(dayId);
            if(document.querySelectorAll('.tab')[idx]) document.querySelectorAll('.tab')[idx].classList.add('active');
            document.body.setAttribute('data-theme', theme);
            const bg = document.getElementById('bg-layer');
            if (bg.style.backgroundImage !== `url('${bgs[dayId]}')`) {
                bg.style.opacity = 0; setTimeout(() => { bg.style.backgroundImage = `url('${bgs[dayId]}')`; bg.style.opacity = 1; }, 300);
            }
            let city = 'osaka'; if (theme === 'kyoto') city = 'kyoto'; if (theme === 'kobe') city = 'kobe';
            fetchWeather(city);
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function toggleMap(card, loc) {
            if(event.target.closest('a')) return;
            card.classList.toggle('expanded');
            const wrap = card.querySelector('.map-wrapper');
            if (card.classList.contains('expanded')) {
                if (!wrap.classList.contains('loaded')) {
                    const enc = encodeURIComponent(loc);
                    wrap.innerHTML = `<iframe class="map-frame" src="http://googleusercontent.com/maps.google.com/maps?q=${enc}&t=&z=15&ie=UTF8&iwloc=&output=embed" frameborder="0"></iframe>`;
                    setTimeout(() => wrap.classList.add('loaded'), 300);
                }
                wrap.style.height = "250px";
            } else { wrap.style.height = "0"; }
        }

        /* å·¥å…·ç®±é‚è¼¯ */
        function toggleModal() {
            const modal = document.getElementById('toolsModal');
            modal.classList.toggle('open');
        }
        function closeModalOnBg(e) {
            if(e.target.id === 'toolsModal') toggleModal();
        }
        function calcRate() {
            const yen = parseFloat(document.getElementById('yenInput').value) || 0;
            const twd = Math.round(yen * 0.22); // ç°¡å–®åŒ¯ç‡ 0.22
            document.getElementById('twdResult').innerText = twd;
        }
        function speak(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'ja-JP';
            speechSynthesis.speak(utterance);
        }

        document.addEventListener('DOMContentLoaded', () => { fetchWeather('osaka'); });
    </script>
</body>
</html>
